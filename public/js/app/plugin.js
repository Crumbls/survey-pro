(function(){window.Alpine?a(window.Alpine):document.addEventListener("alpine:init",()=>{a(window.Alpine)});function a(u){var c={events:{},wildcardEvents:{},on:function(e,t){if(e.includes("*")){var i="^"+e.replace(/\*/g,".*")+"$",n=new RegExp(i);this.wildcardEvents[e]||(this.wildcardEvents[e]={pattern:n,callbacks:[]}),this.wildcardEvents[e].callbacks.push(t);var s=this;return function(){s.wildcardEvents[e].callbacks=s.wildcardEvents[e].callbacks.filter(function(r){return r!==t})}}else{this.events[e]||(this.events[e]=[]),this.events[e].push(t);var s=this;return function(){s.events[e]=s.events[e].filter(function(o){return o!==t})}}},once:function(e,t){var i=this.on(e,function(n){i(),t(n)});return i},emit:function(e,t){var i=!1;if(this.events[e])for(var n=this.events[e],s=0;s<n.length;s++)n[s](t),i=!0;for(var r=Object.keys(this.wildcardEvents),o=0;o<r.length;o++){var l=r[o],h=this.wildcardEvents[l],b=h.pattern,d=h.callbacks;if(b.test(e))for(var f=0;f<d.length;f++)d[f](t,e),i=!0}return i},off:function(e){e.includes("*")?delete this.wildcardEvents[e]:delete this.events[e]},clear:function(){this.events={},this.wildcardEvents={}}};u.magic("bus",function(){return{on:function(e,t){return c.on(e,t)},once:function(e,t){return c.once(e,t)},emit:function(e,t){return c.emit(e,t)},off:function(e){c.off(e)},clear:function(){c.clear()},chain:function(e,t){var i=c;return c.on(e,function(n){i.emit(t,n)})},channel:function(e){var t=e,i=c;return{on:function(n,s){return i.on(t+"."+n,s)},once:function(n,s){return i.once(t+"."+n,s)},emit:function(n,s){return i.emit(t+"."+n,s)},off:function(n){i.off(t+"."+n)},clear:function(){i.off(t+".*")}}}}}),u.data("chat",(e={})=>({open:!1,messages:[],selectedTab:null,agent:{enabled:!1},ticket:{enabled:!1},knowledgebase:{enabled:!0,query:""},init(){const n=((s,r)=>{const o={...s};for(const l in r)typeof r[l]=="object"&&r[l]!==null&&typeof o[l]=="object"&&o[l]!==null?o[l]={...o[l],...r[l]}:o[l]=r[l];return o})({open:!1,agent:{enabled:!1},ticket:{enabled:!1},knowledgebase:{enabled:!1}},e);console.log(this.ticket),console.log(n.ticket),this.applyConfig(this,n),console.log(this.ticket),this.selectedTab||(this.selectedTab=this.firstServiceEnabled()),this.$bus.on("load",function(){console.log("test")}),this.$bus.emit("load",{chat:this})},search(){},chatOpen(){this.open||this.$bus.emit("open"),this.open=!0},chatClose(){this.open&&this.$bus.emit("hidden"),this.open=!1},chatToggle(){this.open?this.$bus.emit("hidden"):this.$bus.emit("open"),this.open=!this.open},applyConfig(t,i){Object.keys(i).forEach(n=>{n in t&&(typeof i[n]=="object"&&i[n]!==null&&typeof t[n]=="object"&&t[n]!==null?this.applyConfig(t[n],i[n]):t[n]=i[n])})},firstServiceEnabled(){return["agent","ticket","knowledgebase"].find(i=>this[i]&&this[i].enabled===!0)}}))}})();
